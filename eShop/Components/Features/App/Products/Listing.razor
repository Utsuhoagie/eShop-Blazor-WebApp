@using eShop.Data
@using Microsoft.AspNetCore.Components.QuickGrid
@using Microsoft.EntityFrameworkCore

@page "/products"
@attribute [StreamRendering]
@inject IDbContextFactory<EShopContext> DbFactory

@code {
	record ProductResponse
	{
		public int Id { get; private set; }
		public string Name { get; private set; }
		public string Price { get; private set; }

		public static ProductResponse New(Product product) => new()
		{
			Id = product.Id,
			Name = product.Name,
			Price = $"${product.Price}",
		};
	}

	List<ProductResponse> Products = new();

	protected override async Task OnInitializedAsync()
	{
		using var context = DbFactory.CreateDbContext();

		Products = await context.Products
			.AsNoTracking()
			.Where(p => true)
			.Select(p => ProductResponse.New(p))
			.ToListAsync();
	}
}

<h1>Listing</h1>

<MudTable
	Items=@Products
	Hover=@true
	>
	<HeaderContent>
		<MudTh>Id</MudTh>
		<MudTh>Name</MudTh>
		<MudTh>Price</MudTh>
	</HeaderContent>

	<RowTemplate>
		<MudTd>@context.Id</MudTd>
		<MudTd>@context.Name</MudTd>
		<MudTd>@context.Price</MudTd>
	</RowTemplate>
</MudTable>